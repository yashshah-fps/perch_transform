data_source:
  name: fct_enrollments
  description: Wayfair enrollments table
  owners:
    - yash.shah@fpsinc.com

  identifiers:
    - name: date
      type: primary
      expr: enrollment_date

  mutability:
    type: immutable

  # CAST(col as datetime) not required when using columns from a data warehouse table or SQL statement based off of a table. It is used here for BigQuery to resolve improperly cast STRING data when using "UNION ALL" data.
  sql_query: |
    SELECT
      enrollment_date
      , sites
      , sum(ib_calls)
      , sum(calls)
    FROM wayfair_enrollment_hourly
    where enrollment_date > '2022-04-10'
    group by 1,2
